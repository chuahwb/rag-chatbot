FROM node:20-alpine

ENV CI=1 \
    HOST=0.0.0.0 \
    VITE_PORT=5173

WORKDIR /app

COPY package*.json ./
RUN npm install

EXPOSE 5173

CMD ["sh", "-c", "set -euo pipefail; if [ ! -d node_modules ]; then npm install; fi; npm run dev -- --host ${HOST:-0.0.0.0} --port ${VITE_PORT}"]

